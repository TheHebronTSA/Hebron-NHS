define("wixCode",["lodash","utils","core","coreUtils","skins","experiment","zepto","warmupUtils","tpa","platformInit","pmrpc","galleriesCommon","platformUtils","thirdPartyAnalytics"],function(e,t,n,i,r,a,s,o,u,c,p,d,l,g){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=774)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},10:function(e,t){e.exports=s},119:function(e,t){e.exports=l},13:function(e,t){e.exports=o},169:function(e,t){e.exports=g},187:function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},2:function(e,t){e.exports=n},239:function(e,t,n){var i;void 0===(i=function(){"use strict";return{MESSAGE_INTENT:{WIX_CODE_MESSAGE:"WIX_CODE",WIX_CODE_SITE_API:"WIX_CODE_SITE_API",WIX_CODE_APP_API:"WIX_CODE_APP_API",SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE:"SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE",SANTA_APPLICATION_CHANNEL_MESSAGE:"SANTA_APPLICATION_CHANNEL_MESSAGE"},MESSAGE_TYPE:{CONSOLE:"console",IFRAME_COMMAND:"wix_code_iframe_command",GOOGLE_ANALYTICS:"googleAnalytics",UPDATE_WIX_CODE_MODEL_DATA_AFTER_LOGIN:"update_wix_code_model_data_after_login",REQUEST_API:"REQUEST_API",PERFORMANCE_METRICS_READY:"performance_metrics_ready",PLATFORM_PUBLIC_API_PREFIX:"viewer_platform_public_api_",OPEN_MESSAGE_CHANNEL:"openMessageChannel",SANTA_READY:"santaReady",SANTA_PAGE_CHANGE:"santaPageChange"}}}.apply(t,[]))||(e.exports=i)},240:function(e,t,n){var i,r;i=[n(0),n(49),n(1),n(4),n(385),n(770),n(239),n(384),n(386),n(70)],void 0===(r=function(e,t,n,i,r,a,s,o,u,c){"use strict";function p(e){return e===s.MESSAGE_INTENT.WIX_CODE_SITE_API}function d(e){return e===s.MESSAGE_INTENT.WIX_CODE_APP_API}function l(e){return e.getSiteAspect("WidgetAspect").getWidgetHandler(e)}function g(e,t,i){var r=l(e);switch(t.type){case s.MESSAGE_TYPE.IFRAME_COMMAND:r.onCommand(t,i);break;case s.MESSAGE_TYPE.CONSOLE:n.logWixCodeConsoleMessage(t);break;case s.MESSAGE_TYPE.REQUEST_API:if(!e.getSiteData().isAddPanelView){var a=s.MESSAGE_TYPE.PLATFORM_PUBLIC_API_PREFIX+t.appDefId+"_"+t.workerId;c.api.request(a,{target:r.getPostMessageTarget(t.workerId)}).then(function(e){c.api.set(a,e)})}break;case s.MESSAGE_TYPE.PERFORMANCE_METRICS_READY:"undefined"!=typeof window&&window.postMessage(t,"*");break;default:r.handleRemoteMessage(t)}}function f(n,i,o){try{e.isString(i)&&(i=JSON.parse(i))}catch(e){return}if(n.getSiteData().isInSSR()?i:function(t,n,i){if(e.get(n,"data.requiresDom")){var r=t.getSiteAspect("wixCodeMessageQueueAspect");if(r.shouldQueueMessage(n))return r.addMessageToQueue(n.data.requiresDom.compId,n,i),null;delete n.data.requiresDom}return n}(n,i,o)){var u=void 0;if(function(e){return e===s.MESSAGE_INTENT.WIX_CODE_MESSAGE}(i.intent))o(i,m(i,l(n)));else if(p(i.intent)){var c=e.defaults({},r,t.tpaHandlers);if(u=m(i,l(n)),c[i.type])try{c[i.type](n,i,u)}catch(e){u(null,e.message)}}else if(d(i.intent)){u=m(i,l(n));try{a.handleAppAPIMessage(n,i,u)}catch(e){u(null,e.message)}}}}function m(t,n){return function(i,r,a){var s={intent:"WIX_CODE_RESPONSE",callbackId:t.callbackId,type:t.type,contextId:t.contextId};if(p(t.intent)||d(t.intent))s=e.merge(s,{result:i,error:r});else{var o={compId:t.compId,command:t.command};i&&e.merge(o,i),s=e.merge(s,{result:o})}try{n.updateComponent(s,a)}catch(e){}}}return{handleMessage:function(t,n,i){f(t,n,i||e.partial(g,t))},getWidgetHandler:l,modifyPostMessage:function(e,t){var n=e.getSiteData(),i=n.rendererModel.wixCodeModel,r=u.getWixCodeSpec(n.getClientSpecMap());return o.getExtendedMessage(t,i,r,n)},registerMessageHandler:function(t,n){t.getWixCodeAppApi().registerMessageHandler(e.partial(n,t))},registerMessageModifier:function(t,n){t.getWixCodeAppApi().registerMessageModifier(e.partial(n,t))},onMessage:f}}.apply(t,i))||(e.exports=r)},383:function(e,t,n){var i,r;i=[n(0),n(4),n(8)],void 0===(r=function(e,t,n){"use strict";var i=t.urlUtils,r="pages",a=".js",s=a+".map",o=["wixCode","nonUndoable","bundleCacheKillers"],u=["wixCode","nonUndoable","defaultBundleCacheKiller"];function c(t,n){var i=e.get(n,o,{}),r=e.get(n,u);return i[t]||r}function p(e,t){return i.joinURL("https://"+e.instanceId+".dev."+t.serviceTopology.wixCloudBaseDomain,r)}function d(e,t,n,a,s){return"site"===s.viewMode?function(e,t,n,a,s){var o="https://"+a.instanceId+".static.pub."+s.serviceTopology.wixCloudBaseDomain;return i.joinURL(o,"static","v2",n.appData.codeAppId,a.instanceId,r,e)+"?empty-if-missing=true&exclude=wix-&module-name="+t}(e,t,n,a,s):function(e,t,n,r,a){var s=p(r,a);return i.joinURL(s,e)+"?empty-if-missing=true&exclude=wix-&module-name="+t+"&viewMode="+a.viewMode+"&instance="+r.instance+"&scari="+n.signedAppRenderInfo+"&cacheKiller="+c(t,a)}(e,t,n,a,s)}function l(t){return e.startsWith(t,"public/pages/")}return{paths:{GLOBAL_CACHE_KILLER:u,CACHE_KILLERS_MAP:o},filePathAffectsBundles:function(t){return e.startsWith(t,"public/")||e.startsWith(t,"backend/")},filePathAffectsSingleBundle:l,bundleIdFromFilePath:function(e){if(!l(e))throw new Error('The path "'+e+'" does not belong to a single bundle');return e.split("public/pages/")[1].split(".")[0]},getUserScript:function(e,t,n,i){var r="masterPage"===e.type?"masterPage":e.id,a=r+".js";return{url:d(a,r,t,n,i),displayName:function(e){return"masterPage"===e.type?"site":e.displayName+" "+("Popup"===e.type?"popup":"page")}(e),scriptName:a}},isUserCodeUrl:function(t,n,i){var r=p(n,i);return e.startsWith(t,r)},getSourceMapUrl:function(e,t,o,u){var p=function(e){var t=e.substring(0,e.indexOf(a));return t.substring(t.lastIndexOf("/")+1)}(e),d=n.isOpen("sv_wixCodeNewDomain",u)?"//"+o.instanceId+".dev.wix-code.com/preview":"//editor."+u.serviceTopology.baseDomain+"/_api/wix-code-dev-dispatcher/preview/";return i.joinURL(d,r,p+s)+"?module-name="+p+"&viewMode="+u.viewMode+"&instance="+o.instance+"&scari="+t+"&cacheKiller="+c(p,u)}}}.apply(t,i))||(e.exports=r)},384:function(e,t,n){var i,r;i=[n(0),n(383),n(239)],void 0===(r=function(e,t,n){"use strict";return{getExtendedMessage:function(i,r,a,s){var o={intent:n.MESSAGE_INTENT.WIX_CODE_MESSAGE};return a&&i.widgets&&(i.widgets=e.map(i.widgets,function(o){return function(e){return"Application"!==e.type||"dataBinding"===e.id}(o)?e.assign({},o,function(e,i,r,a,s){if("load_widgets"===e.type||"load_user_code"===e.type||e.type===n.MESSAGE_TYPE.UPDATE_WIX_CODE_MODEL_DATA_AFTER_LOGIN){var o={appConfig:{scari:r.signedAppRenderInfo,instance:a.instance}};return"Application"!==i.type&&(o.appConfig.userScript=t.getUserScript(i,r,a,s)),o}}(i,o,r,a,s)):o})),e.defaults({},i,o)}}}.apply(t,i))||(e.exports=r)},385:function(e,t,n){var i,r;i=[n(0),n(10),n(1),n(4),n(169),n(13),n(119),n(769)],void 0===(r=function(e,t,n,i,r,a,s,o){"use strict";var u=i.linkTypes,c=function(e){return!!e.getRenderFlag("isExternalNavigationAllowed")||(e.getRenderRealtimeConfigItem("previewTooltipCallback")(function(e,t){var n=void 0!==window.screenLeft?window.screenLeft:window.screen.left,i=void 0!==window.screenTop?window.screenTop:window.screen.top,r=void 0;return r=window.innerWidth?window.innerWidth:window.document.documentElement.clientWidth?window.document.documentElement.clientWidth:window.screen.width,{top:(window.innerHeight?window.innerHeight:window.document.documentElement.clientHeight?window.document.documentElement.clientHeight:window.screen.height)/2-t/2+i,left:r/2-e/2+n}}(50,20),"text_editor_inactive_link_on_preview"),!1)},p=function(t,n,i){!function(e,t){var n=e.getSiteAspect("siteMembers");n.isLoggedIn()?n.getMemberDetails(t,function(e){t(null,e)}):e.getSiteData().isPreviewMode()?n.getMemberDetailsInPreview(t,function(e){t(null,e)}):t(null,"No user is currently logged in")}(t,function(t,r){if(r)n(null,r);else{var a=e.isObject(t)&&i.extract(t);a?n(a):n(null,i.errorMsg)}})},d=function(e,t){var n=e||{};t(null,{status:n.status,responseText:n.responseText})};return{reportBI:function(e,t){e.reportBI(t.reportDef,t.params)},windowBoundingRect:function(t,n,i){var r=t.getSiteAspect("windowScrollEvent");i({window:t.getWindowSize(),scroll:e.pick(r.getScrollPosition(),["x","y"]),document:t.getDocumentSize()})},navigateTo:function(t,n){if(!t.getSiteData().isInSSR())switch(n.data.type){case u.EXTERNAL_LINK:n.data.url&&c(t)&&window.open(n.data.url,"_self");break;case u.EMAIL_LINK:var r=i.linkUtils.getEmailLink(n.data);r&&c(t)&&window.open(r,"_self");break;case u.PHONE_LINK:window.open(i.linkUtils.getPhoneLink(n.data),"_self");break;case u.DOCUMENT_LINK:var a=i.linkUtils.getDocumentLink(n.data,t.getSiteData());window.open(a,"_self");break;default:!function(t,n){var i={pageId:t.getSiteData().getPrimaryPageId()};if(n.pageId)if("#"===n.pageId)e.assign(i,{pageId:t.getSiteData().getMainPageId()});else{var r=function(e,t){return e.getSiteData().findDataOnMasterPageByPredicate(function(e){return e.pageUriSEO===t||e.id===t})}(t,n.pageId);e.assign(i,{pageId:"masterPage"===r.id?i.pageId:r.id})}if(n.routerId){var a=e.get(t.getSiteData(),["routers","configMap",n.routerId]),s=n.innerRoute?a.prefix+"/"+n.innerRoute:a.prefix;a&&(i={routerDefinition:a,innerRoute:n.innerRoute,pageAdditionalData:s})}n.anchorDataId&&e.assign(i,{anchorData:n.anchorDataId}),n.queryParams&&e.assign(i,{queryParams:n.queryParams}),n.tpaInnerRoute&&(e.assign(i,{tpaInnerRoute:n.tpaInnerRoute}),i.pageId===t.getSiteData().getPrimaryPageId()&&t.updatePageNavInfo(i)),t.handleNavigation(i,"#",!0)}(t,n.data)}},postHtmlMessage:function(e,t){var n=t.data;e.getSiteAspect("HtmlPostMessageAspect").postMessage(n.id,n.msg)},openLightbox:function(e,t,n){var i=t.data.id,r=e.getSiteAspect("PopupPageAspect");e.getRuntimeDal().setPopupContext(i,t.data.context),n&&r.registerCloseHandler(i,n),r.openPopupPage(i)},closeLightbox:function(e,t){var n=t.data.id;e.getCurrentPopupId()===n&&e.getSiteAspect("PopupPageAspect").closePopupPage(t.data.returnedData)},getRoutersSiteMap:function(t,i,r){var a=t.getSiteData(),s=e.find(a.routers.configMap,{prefix:i.data.prefix})||{},o=n.routersBackEndRequests.makeParamObjFromSiteData(a,s,{});n.routersBackEndRequests.getInnerRoutesSiteMap(o,function(e){r(e)},function(t){return r(null,e.get(t,"message",t))},a)},startFileUpload:function(e,t,n){e.getComponentById(t.data.compId).uploadFiles(n)},getCurrentGeolocation:function(t,n,i){window.navigator.geolocation.getCurrentPosition(function(t){i({timestamp:e.get(t,"timestamp"),coords:e.toPlainObject(e.get(t,"coords"))})},function(e){i(null,e&&e.message)})},scrollToComponent:function(e,t,n){e.scrollToComponent(t.data.compId,{onComplete:function(){n()}})},smCurrentUserEmail:function(e,t,n){p(e,n,{extract:function(e){return e.email},errorMsg:"Unable to retrieve user email"})},smCurrentUserSlug:function(e,t,n){p(e,n,{extract:function(e){return e.slug},errorMsg:"Unable to retrieve user slug"})},smCurrentUserRoles:function(t,i,r){var a=e.find(t.getSiteData().getClientSpecMap(),{appDefinitionId:"675bbcef-18d8-41f5-800e-131ec9e08762"});if(e.get(a,"instance")){var o=t.getSiteData().getExternalBaseUrl().replace(/\/$/,"");n.ajaxLibrary.ajax({url:o+"/_api/members-groups-web/v1/groups/users/current?include_implicit_groups=true",type:"GET",dataType:"json",contentType:"application/json",processData:!1,headers:{Authorization:"wixcode-pub."+a.instance},success:function(e){var t=s.platformizedEndpointsUtils.members.serializeMemberRoles(e);r(t)},error:function(e){d(e,r)}})}else r(null,"wix code is not enabled")},smLogout:function(t,n,r){var a=t.getSiteAspect("siteMembers");if(a.isLoggedIn()){var s=e.isEmpty(n.data)?null:function(){if(n.data.type===u.EXTERNAL_LINK&&n.data.url&&c(t))window.open(n.data.url,"_self");else{var e={pageId:{id:n.data.pageId},type:n.data.type,queryParams:n.data.queryParams},r=t.getSiteData(),a=i.linkRenderer.renderLink(e,r,r.getRootNavigationInfo());t.href(a.href)}};a.logout(null,r,function(e){return r(null,e)},{navigateToPage:s})}else r(null,"No member is logged in")},smForgotPassword:function(t,n,i){var r=e.get(n,["data","language"]),a=t.getSiteAspect("siteMembers"),s=!1;a.isLoggedIn()?i(null,"User is already logged in"):a.showResetPasswordDialog(r||null,function(){s=!0},function(){s?i():i(null,"The user closed the forgot password dialog")})},googleAnalytics:function(e,t){r.reportGoogleAnalytics.apply(null,[e.getSiteData()].concat(t.data))},sendMessageToParent:function(e,t){window.parent!==window&&e.getSiteData().isViewerMode()&&window.parent.postMessage(t.data,"*")},sendUserEmail:function(t,i,r){var a=e.find(t.getSiteData().getClientSpecMap(),{appDefinitionId:"135c3d92-0fea-1f9d-2ba5-2a1dfb04297e"});if(e.get(a,"instance")){var s=i.data,o=s.emailId,u=s.contactId,c=s.options;if("user"!==s.type||t.getSiteAspect("siteMembers").isLoggedIn()){var p=t.getSiteData().getExternalBaseUrl().replace(/\/$/,"");n.ajaxLibrary.ajax({url:p+"/_api/shoutout/v1/emailContact",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({emailId:o,contactId:u,options:c}),processData:!1,headers:{Authorization:a.instance},success:function(){r()},error:function(e){d(e,r)}})}else r(null,"User must be logged-in in order to send an email")}else r(null,"shoutout app not installed")},openMessageChannel:function(t,n,i,r){if(window.parent!==window&&t.getSiteData().isViewerMode()){var a=n.data;e.isString(a)&&(a=JSON.parse(n.data));var s=t.getSiteAspect("wixCodeMessageChannelAspect").getMessageChannel(a.appDefinitionId);i({appDefinitionId:a.appDefinitionId},null,r?[s.port2]:[s.port1])}else i(null,"DID NOT CREATE MESSAGE CHANNEL")},smRegisterUser:function(t,n,i){var r=e.get(n,["data","email"]),a=e.get(n,["data","password"]),o=e.get(n,["data","contactInfo"],{}),u=s.platformizedEndpointsUtils.contacts.serializeContactInfo(o);t.getSiteAspect("siteMembers").registerUser(r,a,u,function(t,n){if(t){var r={status:"ACTIVE"===t.member.status?"ACTIVE":"PENDING",memberData:e.omit(t.member,"status")};t.approvalToken&&(r.approvalToken=t.approvalToken),i(r)}else d(n,i)})},smLoginUser:function(t,n,i){var r=e.get(n,["data","email"]),a=e.get(n,["data","password"]);t.getSiteAspect("siteMembers").loginUser(r,a,function(e,t){t?d(t,i):i()})},smApplySessionToken:function(t,n,i){var r=e.get(n,["data","token"]);t.getSiteAspect("siteMembers").authenticateSession(r,function(e){e?i(null,"sessionToken token is invalid"):i()})},mlSetLanguageCode:function(e,t){var n=a.multilingual,i=e.getSiteDataAPI(),r=e.getDisplayedDAL(),s=e.getPointers();n.setCurrentLanguage({siteDataAPI:i,dal:r,pointers:s})(t.data.languageCode)},crmCreateContact:function(t,i,r){var a=e.find(t.getSiteData().getClientSpecMap(),{appDefinitionId:"675bbcef-18d8-41f5-800e-131ec9e08762"});if(e.get(a,"instance")){var o=(e.startsWith(a.instance,"wixcode-pub.")?"":"wixcode-pub.")+a.instance,u=i.data.contactInfo;n.ajaxLibrary.ajax({url:"/_api/wix-contacts-webapp/v3/contacts",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({contact:s.platformizedEndpointsUtils.contacts.serializeContactInfo(u)}),processData:!1,headers:{Authorization:o},success:function(e){r(e)},error:function(e){d(e,r)}})}else r(null,"wix code is not enabled")},publishPubSubEvent:o.publish,subscribePubSubEvent:o.subscribe,unsubscribePubSubEvent:o.unsubscribe}}.apply(t,i))||(e.exports=r)},386:function(e,t,n){var i,r;i=[n(0),n(54)],void 0===(r=function(e,t){"use strict";function n(e){return t.specMapUtils.getAppSpec(e)}return{hasWixCodeWidgetSpecs:function(e){return!!n(e)},getWixCodeSpec:n}}.apply(t,i))||(e.exports=r)},4:function(e,t){e.exports=i},49:function(e,t){e.exports=u},54:function(e,t){e.exports=c},7:function(e,t){e.exports=r},70:function(e,t){e.exports=p},762:function(e,t,n){var i;void 0===(i=function(){"use strict";var e={"wysiwyg.viewer.skins.WixCodeWidgetSkin":{react:[["iframe","iframe",[],{}]],css:{"% iframe":"display:none;"}}};return e}.apply(t,[]))||(e.exports=i)},763:function(e,t,n){(function(i){var r,a;r=[n(0),n(1)],void 0===(a=function(e,t){"use strict";var n={INFO:"info",WARN:"warn",ERROR:"error"},r=/\[request-id:\s(\d+\.\d+)\]/,a=e.noop,s=[-12,-15,-16],o="Message was not specified although level is error. See stack_trace",u=["ReactSource","EditorSource","experiments","petri_ovr","WixCodeRuntimeSource","js-wixcode-sdk-override","debug","debugViewer"];function c(){try{var n=e.get(window.parent,"location.href"),i=t.urlUtils.parseUrl(n),r=Object.keys(i.query).some(function(e){return"wixCodeForceKibanaReport"===e}),a=!!n&&(function(t){return e.includes(t,"://localhost")}(n)||function(n){var i=t.urlUtils.parseUrl(n);return Object.keys(i.query).some(function(t){return e.includes(u,t)})}(n));return r||!a}catch(e){return!0}}function p(n,r,s){if("undefined"!=typeof window&&c()&&(!window.isMockWindow||void 0===i||i.jasmine.isSpy(t.ajaxLibrary.ajax))){s||(s=1);var o=function(t){return e.flow(g,f,m,A,I,S,v,d,y,E)(t)}(n);(function(e,n){var i={type:"POST",url:e+"/logstash/events",dataType:"json",contentType:"application/json",data:JSON.stringify(n),xhrFields:{withCredentials:!0},crossDomain:!0};return new Promise(function(e,n){i.success=e,i.error=function(e,t,i){n({xhr:e,errorType:t,error:i})},t.ajaxLibrary.ajax(i)})})(r,o).then(a,function(){s>2?function(t){var n=window.localStorage.getItem("wixCodePendingMonitoring"),i=void 0;try{var r=n?JSON.parse(n):[];i=e.isArray(r)?r:[]}catch(e){i=[]}var a=JSON.stringify(i.concat(t));try{window.localStorage.setItem("wixCodePendingMonitoring",a)}catch(e){}}(o):p(n,r,s+1),a()})}}function d(t){if(!e.isError(t.message))return t;var n=t.message,i={};return n.stack?(i.stackTrace=n.stack,i.message=n.message):i.message=n.toString(),e.merge({},t,i)}function l(t){return e.isError(t)&&!!t.xhr}function g(t){if(!l(t.message))return t;var n=e.assign({x_seen_by:t.message.xhr.getResponseHeader("x-seen-by")},e.mapKeys(e.get(t,"message.request.headers"),function(t,n){return e.snakeCase(n)}));return e.merge({},t,{params:n})}function f(t){if(!l(t.message))return t;var n=function(e){var t=r.exec(e);if(t&&t[1])return t[1]}(h(t.message.xhr.responseText).errorDescription);return n?e.merge({},t,{requestId:n}):t}function m(t){if(!l(t.message))return t;var n=h(t.message.xhr.responseText).errorCode;return e.isNil(n)?t:e.merge({},t,{errorCode:n.toString()})}function S(t){if(!l(t.message))return t;var i=h(t.message.xhr.responseText).errorCode;return i&&e.includes(s,i)?e.merge({},t,{level:n.WARN}):t}function A(t){return function(t){return e.isError(t)&&"RequestAbortError"===t.name}(t.message)?e.merge({},t,{level:n.WARN}):t}function I(t){return function(t){return e.isError(t)&&"RequestTimeoutError"===t.name}(t.message)?e.merge({},t,{level:n.WARN}):t}function h(e){if(!e)return{};try{return JSON.parse(e)}catch(e){return{}}}function v(t){return t.message||t.level!==n.ERROR?t:e.merge({},t,{message:new Error(o)})}function y(t){return e.isString(t.message)?t:e.merge({},t,{message:JSON.stringify(t.message)})}function E(t){return e.merge({},t,{params:{url:e.get(window,"location.href","")}})}return{levels:n,trace:function(i,r){!function(t){if(!e.isString(t)||0===t.length)throw new Error("parameter `baseUrl` is invalid, received: "+t)}(r);var a=new Date,s=a.getTime(),o=e.merge({},{source:"wix-code-client",level:n.INFO,userActionId:t.guidUtils.getGUID()},i,{timestamp:a.toJSON(),actionPosition:"start"});return p(o,r),function(t){var n=new Date,i=(n.getTime()-s)/1e3;p(t=e.merge({},o,t,{timestamp:n.toJSON(),duration:i,actionPosition:"end"}),r)}},_setResponseCallback:function(t){a=t||e.noop}}}.apply(t,r))||(e.exports=a)}).call(this,n(187))},764:function(e,t,n){var i,r;i=[n(0),n(239),n(385),n(49)],void 0===(r=function(e,t,n,i){"use strict";function r(r){var a=this,s=r.data;if(e.isString(s))try{s=JSON.parse(r.data)}catch(e){return}if(function(e){return e===t.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE}(s.intent))switch(s.type){case t.MESSAGE_TYPE.OPEN_MESSAGE_CHANNEL:i.tpaHandlers.waitForWixCodeWorkerToBeReady(this.siteAPI,r,function(){n[s.type](a.siteAPI,r,function(n){return function(i,r,a){var s=e.assign(i,{intent:t.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE,type:n.data.type,error:r,callbackId:n.data.callbackId});window.parent.postMessage(s,"*",a)}}(r),!0)})}}function a(e){this.aspectSiteAPI=e,this.siteAPI=e.getSiteAPI(),this.messageChannel={},this.siteAPI.getSiteData().isInSSR()||window.parent!==window&&this.siteAPI.getSiteData().isViewerMode()&&(this.aspectSiteAPI.registerToMessage(r.bind(this)),this.aspectSiteAPI.registerToSiteReady(function(){var e={intent:t.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE,type:t.MESSAGE_TYPE.SANTA_READY};window.parent.postMessage(e,"*")}.bind(this)),this.aspectSiteAPI.registerToUrlPageChange(function(){this.messageChannel={};var e={intent:t.MESSAGE_INTENT.SANTA_APPLICATION_CHANNEL_MESSAGE_RESPONSE,type:t.MESSAGE_TYPE.SANTA_PAGE_CHANGE};window.parent.postMessage(e,"*")}.bind(this)))}return a.prototype={getMessageChannel:function(e){return this.messageChannel[e]?this.messageChannel[e]:(this.messageChannel[e]=new MessageChannel,this.messageChannel[e])}},a}.apply(t,i))||(e.exports=r)},765:function(e,t,n){var i,r;i=[n(0),n(1),n(4),n(240)],void 0===(r=function(e,t,n,i){"use strict";function r(e){this.aspectSiteAPI=e,this.siteAPI=e.getSiteAPI(),this.messageQueue=[],this._currentPageId=null,e.registerToDidLayout(this.flushQueue.bind(this)),e.registerToOnRendered(function(){this._currentPageId=this.siteAPI.getSiteData().getCurrentUrlPageId(),this.flushQueueOnRender()}.bind(this)),e.registerToUrlPageChange(function(){this._currentPageId=null}.bind(this))}function a(n,i){var r=e.keys(n.getComponentsByPageId(t.siteConstants.MASTER_PAGE_ID)),a=e.keys(n.getComponentsOnFocusedPage()),s=e.union(r,a);return e.includes(s,i)}return r.prototype={flushQueueOnRender:function(){e.forEach(this.messageQueue,function(t,r){!e.isNil(t)&&(t.compId===n.constants.COMP_IDS.WINDOW&&this._currentPageId===t.message.contextId)&&(delete t.message.data.requiresDom,i.onMessage(this.siteAPI,t.message,t.handler),this.messageQueue.splice(r,1))}.bind(this))},flushQueue:function(){e.forEach(this.messageQueue,function(e,t){e&&a(this.siteAPI,e.compId)&&(delete e.message.data.requiresDom,i.onMessage(this.siteAPI,e.message,e.handler),this.messageQueue.splice(t,1))}.bind(this))},addMessageToQueue:function(e,t,n){this.messageQueue.push({compId:e,message:t,handler:n})},shouldQueueMessage:function(t){var i=e.get(t,"data.requiresDom.compId");return i===n.constants.COMP_IDS.WINDOW?this._currentPageId!==t.contextId:!a(this.siteAPI,i)}},r}.apply(t,i))||(e.exports=r)},766:function(e,t,n){var i,r;i=[n(0),n(93),n(4)],void 0===(r=function(e,t,n){"use strict";var i=t.utils.galleriesHelperFunctions,r=n.matrixCalculations;return{setCompLayoutOnDataChange:function(e,t,n){if("ImageList"===t.value.type){var a=this.siteAPI.getRuntimeDal(),s=a.getCompData(e),o=a.getCompProps(e),u=a.getCompLayout(e),c=a.getCompStructure(e),p=n.items,d=s.items,l=u.height,g=r.getAvailableRowsNumber(o.maxRows,o.numCols,p.length),f=r.getAvailableRowsNumber(o.maxRows,o.numCols,d.length),m=Math.max(i.MIN_GALLERY_HEIGHT,i.getGalleryHeight(g,f,o.margin,c.skin,l));a.updateCompLayout(e,{height:m})}}}}.apply(t,i))||(e.exports=r)},767:function(e,t,n){var i,r;i=[n(0),n(4)],void 0===(r=function(e,t){"use strict";var n=t.dataResolver;return{handleRepeaterDataChange:function(i,r,a){var s=this.siteAPI,o=r.value,u=s.getRuntimeDal().getCompPointer(i);!function(i,r,a){if(!e.isEmpty(a)){var s=i.getSiteData(),o=i.getPointers(),u=i.getRuntimeDal(),c=o.components.getPageOfComponent(r).id,p=o.full.components.getChildrenRecursively(r);e.forEach(p,function(r){var p=e.replace(i.getSiteDataAPI().document.getFullStructureProperty(r,"dataQuery"),"#",""),d=e.replace(i.getSiteDataAPI().document.getFullStructureProperty(r,"designQuery"),"#","");if(p){var l=e.defaults({},u.getCompDataOverrides(r.id),s.getDataByQuery(p,c));e.forEach(a,function(a){var u=t.displayedOnlyStructureUtil.getUniqueDisplayedId(r.id,a),d=n.cloneDataItemWithNewRefIdsRecursively(l,s.dataTypes.DATA,"_runtime_",s.getClonedDataItemsIdsMap(u));d.id=t.displayedOnlyStructureUtil.getUniqueDisplayedId(p,a);var g=n.getFlatMapOfNestedItem(d,s.dataTypes.DATA);e.forOwn(g,function(e){i.getDisplayedDAL().set(o.data.getDataItem(e.id,c),e)})})}if(d){var g=e.defaults({},u.getCompDesignOverrides(r.id),s.getDataByQuery(d,c,s.dataTypes.DESIGN));e.forEach(a,function(a){var u=t.displayedOnlyStructureUtil.getUniqueDisplayedId(r.id,a),p=n.cloneDataItemWithNewRefIdsRecursively(g,s.dataTypes.DESIGN,"_runtime_",s.getClonedDataItemsIdsMap(u));p.id=t.displayedOnlyStructureUtil.getUniqueDisplayedId(d,a);var l=n.getFlatMapOfNestedItem(p,s.dataTypes.DESIGN);e.forOwn(l,function(e){i.getDisplayedDAL().set(o.data.getDesignItem(e.id,c),e)})})}var f=u.getCompBehaviorsOverrides(r.id);e.isEmpty(f)||e.forEach(a,function(e){u.addActionsAndBehaviors(t.displayedOnlyStructureUtil.getUniqueDisplayedId(r.id,e),f)});var m=u.getCompPropsOverrides(r.id);e.isEmpty(m)||e.forEach(a,function(e){u.setCompProps(t.displayedOnlyStructureUtil.getUniqueDisplayedId(r.id,e),m)})})}}(s,u,e.difference(o.items,a.items)),function(i,r,a){if(!e.isEmpty(a)){var s=i.getSiteData(),o=i.getPointers(),u=o.components.getPageOfComponent(r).id,c=o.full.components.getChildrenRecursively(r);e.forEach(c,function(r){var c=e.replace(i.getSiteDataAPI().document.getFullStructureProperty(r,"dataQuery"),"#",""),p=e.replace(i.getSiteDataAPI().document.getFullStructureProperty(r,"designQuery"),"#",""),d=i.getRuntimeDal();e.forEach(a,function(a){var l=t.displayedOnlyStructureUtil.getUniqueDisplayedId(r.id,a);if(d.clearCompRuntimeOverrides(l),c){var g=t.displayedOnlyStructureUtil.getUniqueDisplayedId(c,a),f=s.getDataByQuery(g,u),m=n.getFlatMapOfNestedItem(f,s.dataTypes.DATA,!0);e.forOwn(m,function(e,t){i.getDisplayedDAL().remove(o.data.getDataItem(t,u))})}if(p){var S=t.displayedOnlyStructureUtil.getUniqueDisplayedId(p,a),A=s.getDataByQuery(S,u,s.dataTypes.DESIGN),I=n.getFlatMapOfNestedItem(A,s.dataTypes.DESIGN);e.forOwn(I,function(e,t){i.getDisplayedDAL().remove(o.data.getDesignItem(t,u))})}})})}}(s,u,e.difference(a.items,o.items)),s.getSiteDataAPI().createDisplayedNode(u)}}}.apply(t,i))||(e.exports=r)},768:function(e,t,n){var i,r;i=[n(0),n(767),n(766)],void 0===(r=function(e,t,n){"use strict";function i(t){this.siteAPI=t,this.DATA="dataChange",this.compsPlugin={dataChange:{}},this.registerListeners();var n=this.handleRuntimeDalCompChange.bind(this);t.getRuntimeDal().registerChangeListener(n),this.applySsrChanges=function(t){e.forEach(this.siteAPI.getSiteData().ssr.pendingRuntimeDalChanges,function(e){t(e.compId,e.changeObject,e.dataBeforeChange)})}.bind(this,n)}return i.prototype={getSiteAPI:function(){return this.siteAPI},getPlugin:function(e,t){return this.compsPlugin[e.type]&&this.compsPlugin[e.type][t]?this.compsPlugin[e.type][t]:null},handleRuntimeDalCompChange:function(e,t,n){var i=this.getSiteAPI().getRuntimeDal().getCompStructure(e);if(t&&i&&i.componentType){var r=this.getPlugin(t,i.componentType);r&&r.call(this,e,t,n)}},registerListeners:function(){this.registerCompListener(this.DATA,"wysiwyg.viewer.components.MatrixGallery",n.setCompLayoutOnDataChange),this.registerCompListener(this.DATA,"wysiwyg.viewer.components.Repeater",t.handleRepeaterDataChange)},registerCompListener:function(e,t,n){this.compsPlugin[e][t]=n}},i}.apply(t,i))||(e.exports=r)},769:function(e,t,n){var i;void 0===(i=function(){"use strict";var e="WORKER_";return{publish:function(t,n){t.getSiteAspect("tpaPubSubAspect").publish(n.appDefId,e+n.workerId,n.msgData)},subscribe:function(e,t){t.msgData&&e.getSiteAspect("tpaPubSubAspect").subscribeAsPlatformWorker(t.appDefId,t.workerId,t.msgData.eventKey,t.msgData.receivePastEvents,t.msgData.callbackId)},unsubscribe:function(e,t){var n=e.getSiteAspect("tpaPubSubAspect"),i=t.appDefId,r=t.msgData.eventKey;n.unsubscribeAsPlatformWorker(i,t.workerId,r)}}}.apply(t,[]))||(e.exports=i)},770:function(e,t,n){var i,r;i=[n(0),n(70),n(1)],void 0===(r=function(e,t,n){"use strict";function i(e,i,r,a,s){return t.api.request("publicApi",{initiator:i}).then(function(t){if(!t[r])throw new Error("Api for component with id "+e+" does not contain function "+r);return t[r].apply(t,a)}).then(s).catch(function(e){n.log.error(e.message),s(null,e.message)})}function r(e){var t=e.getIframe();return t&&t.id}return{handleAppAPIMessage:function(t,a,s){var o=t.getSiteAspect("tpaComponentsDomAspect"),u=e.get(a.data,"compId");o.getComponentWhenReady(u).then(function(t){if(!t)throw new Error("comp "+u+" does not exist");var n=e.get(a.data,"fn"),o=e.get(a.data,"fnArgs");switch(a.type){case"invokeAppFn":i(u,r(t),n,o,s);break;case"invokeAppOn":i(u,r(t),n,[s],s)}}).catch(function(e){n.log.error(e.message),s(null,e.message)})}}}.apply(t,i))||(e.exports=r)},771:function(e,t,n){var i,r;i=[n(240)],void 0===(r=function(e){"use strict";return function(t){this.siteAPI=t,e.registerMessageHandler(this.siteAPI,e.handleMessage),e.registerMessageModifier(this.siteAPI,e.modifyPostMessage)}}.apply(t,i))||(e.exports=r)},772:function(e,t,n){var i,r;i=[n(0),n(54)],void 0===(r=function(e,t){"use strict";function n(e){var t=this;this._aspectSiteAPI=e,this._aspectSiteAPI.registerToSiteReady(function(){var e=t._aspectSiteAPI.getSiteAspect("siteMembers");t.callbackId=e.registerToUserLogin(function(){t.isAppInitiated()||t.initApp(),e.unRegisterToUserLogin(t.callbackId)})})}return n.prototype={initApp:function(){var n=this._aspectSiteAPI.getSiteData(),i=this._aspectSiteAPI.getWixCodeAppApi(),r=e.get(n,["currentUrl","query","viewerPlatformAppSources"]),a=t.appsUtils.getAppsBaseInfo({rendererModel:n.rendererModel,clientSpecMap:n.getClientSpecMap(),serviceTopology:n.serviceTopology,viewerPlatformAppSources:r}),s=t.wixCodeUrlUtils.buildScriptsSources(n.serviceTopology,{isDebug:n.hasDebugQueryParam()}),o=s.sdkSource,u=s.namespacesSdkSource,c=s.externalComponentsSource,p=s.wixCodeNamespacesAndElementorySupportSource,d="//unpkg.parastorage.com/react@16.0.0/umd/react"+(n.hasDebugQueryParam()?".development.js":".production.min.js"),l="//unpkg.parastorage.com/react-dom@16.0.0/umd/react-dom"+(n.hasDebugQueryParam()?".development.js":".production.min.js");i.init(n,n.getClientSpecMap(),{isMobileView:n.isMobileView(),debug:n.isDebugMode(),sdkSource:o,namespacesSdkSource:u,externalComponentsSource:c,wixCodeNamespacesAndElementorySupportSource:p,runtimeSource:e.get(n,["currentUrl","query","WixCodeRuntimeSource"]),ReactLibSource:d,ReactDomSource:l,ReactSource:e.get(n,["currentUrl","query","ReactSource"]),applications:a})},isAppInitiated:function(){return this._aspectSiteAPI.getWixCodeAppApi().isAppInitiated()},destroyAppsContainer:function(){this._aspectSiteAPI.getWixCodeAppApi().destroyAppsContainer()}},n}.apply(t,i))||(e.exports=r)},773:function(e,t,n){var i,r;i=[n(2),n(772),n(771),n(768),n(765),n(764)],void 0===(r=function(e,t,n,i,r,a){"use strict";var s=e.siteAspectsRegistry;s.registerSiteAspect("wixCodeWidgetAspect",t),s.registerSiteAspect("wixCodePostMessageAspect",n),s.registerSiteAspect("wixCodeChangeHooksAspect",i),s.registerSiteAspect("wixCodeMessageQueueAspect",r),s.registerSiteAspect("wixCodeMessageChannelAspect",a)}.apply(t,i))||(e.exports=r)},774:function(e,t,n){var i,r;i=[n(386),n(773),n(384),n(763),n(383),n(240),n(7),n(762)],void 0===(r=function(e,t,n,i,r,a,s,o){"use strict";return s.skinsMap.addBatch(o),{wixCodeWidgetService:e,log:i,messageBuilder:n,wixCodeUserScriptsService:r,wixCodePostMessageService:a}}.apply(t,i))||(e.exports=r)},8:function(e,t){e.exports=a},93:function(e,t){e.exports=d}})});
//# sourceMappingURL=wixCode.min.js.map