define("textCommon",["lodash","utils","core","santaProps","coreUtils","prop-types","santa-components","skins","experiment","color"],function(t,e,n,i,o,r,s,a,l,c){return function(t){var e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return t[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(i,o,function(e){return t[e]}.bind(null,o));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1733)}({0:function(e,n){e.exports=t},1:function(t,n){t.exports=e},1733:function(t,e,n){var i,o;i=[n(1734),n(1735),n(1736),n(1737)],void 0===(o=function(t,e,n,i){"use strict";return{textCompMixin:t,textScaleMixin:e,textComponentsUtils:i,baseTextInput:n}}.apply(e,i))||(t.exports=o)},1734:function(t,e,n){var i,o;i=[n(0),n(5),n(2),n(6),n(3),n(1),n(4)],void 0===(o=function(t,e,n,i,o,r,s){"use strict";var a=r.xss.filterHtmlString,l=function(t){var e=t.compData;return s.fonts.collectFontsFromTextDataArray(e.text)};return l.fontsTypes={compData:i.santaTypesDefinitions.Component.compData},{propTypes:{reportBI:o.Types.reportBI,id:o.Types.Component.id.isRequired,skin:o.Types.Component.skin.isRequired,style:o.Types.Component.style.isRequired,scale:o.Types.Component.scale,isPreviewMode:o.Types.isPreviewMode,isMobileView:o.Types.isMobileView.isRequired,title:e.string},mixins:[n.compMixins.customSkinBasedComp({customFontsFunc:l})],componentWillMount:function(){this.updateHTML(this.props)},updateHTML:function(t){this._componentHtml=a(t.compData.text||"",{allowIframes:this.allowIframes}),this.convertCompDataTextToHTML(t)},componentWillReceiveProps:function(t){this.updateHTML(t)},getRootStyle:function(e){var n=t.clone(e||{});"hidden"!==(n["overflow-y"]||n.overflowY)&&(n.height="auto");var i=this.getMinHeight&&this.getMinHeight();return i&&(n.minHeight=i),n},getSkinProperties:function(){this.lastScale=this.props.scale||1;var e=this.props.skin,n=this.getMinHeight&&this.getMinHeight(),i=t.get(this.props.compProp,"packed",!1)||this.props.isMobileView&&this.props.isPreviewMode,o={"":t.assign({"data-packed":i,style:this.getRootStyle(this.props.style)},n&&{"data-min-height":n})},r=void 0;r="wysiwyg.viewer.skins.WRichTextSkin"===e||"wysiwyg.viewer.skins.WRichTextClickableSkin"===e?o.richTextContainer={}:o[""],t.isString(this._componentHtml)?r.dangerouslySetInnerHTML={__html:this._componentHtml||""}:r.children=this._componentHtml,this.props.title&&(o[""].title=this.props.title);var s=t.get(this.props,["compProp","overrideAlignment"]);return s&&(r.className=this.classSet(t.zipObject(["override-"+s],[!0]))),o}}}.apply(e,i))||(t.exports=o)},1735:function(t,e,n){var i,o;i=[n(7),n(6)],void 0===(o=function(t,e){"use strict";return e.mixins.textScaleMixin(t.skinsMap)}.apply(e,i))||(t.exports=o)},1736:function(t,e,n){var i,o;i=[n(0),n(5),n(3),n(2)],void 0===(o=function(t,e,n,i){"use strict";var o=i.compMixins,r={style:{display:"none"}};function s(t){return{$label:t.compProp.label?"hasLabel":"noLabel"}}var a=function(t){return i.compMixins.validatableMixin.getPublicState(t)};return{mixins:[o.skinBasedComp,o.runTimeCompData,o.validatableMixin.validatable,o.compStateMixin(a)],propTypes:{compData:n.Types.Component.compData.isRequired,compProp:n.Types.Component.compProp.isRequired,structure:n.Types.Component.structure.isRequired,shouldResetComponent:n.Types.RenderFlags.shouldResetComponent,isPreset:e.bool,onChange:e.func,message:e.string},BASE_TEXT_BEHAVIORS:t.assign({},i.compMixins.validatableMixin.VALIDATABLE_BEHAVIORS),getInitialState:function(){return t.assign(a(),s(this.props),{value:this.props.compData.value})},componentWillReceiveProps:function(e){e.shouldResetComponent&&e.shouldResetComponent!==this.props.shouldResetComponent&&this.hideValidityIndication();var n=s(e);t.has(e.compData,"value")&&e.compData.value!==this.state.value&&(n.value=e.compData.value),this.setState(n)},_handleClick:function(t){this.props.isPreset&&t.target.select()},setCustomValidity:function(t){this.refs.input.setCustomValidity(t)},_handleChange:function(t){var e=t.target.value;e!==this.state.value&&(this.setState({value:e},function(){this.updateData({value:e})}.bind(this)),this.hideValidityIndication(),this.latestChangeEvent=t)},_handleBlur:function(t){this.props.onChange&&this.props.onChange(t),this.handleAction("blur",t),this.latestChangeEvent&&(this.handleAction("change",this.latestChangeEvent),this.latestChangeEvent=null),this.showValidityIndication()},_handleFocus:function(t){this.handleAction("focus",t)},_handleKeyDown:function(t){this.handleAction("keyPress",t)},getBaseTextInputSkinProperties:function(){var e=this.props.compProp;return{label:e.label?{children:e.label}:r,input:function(){var e=this.props.compProp,n=this.props.compData,i={type:n.textType,name:n.name||this.props.structure.nickname,value:this.state.value,onChange:this._handleChange,onBlur:this._handleBlur,onFocus:this._handleFocus,onClick:this._handleClick,onKeyDown:this._handleKeyDown,disabled:e.isDisabled,required:e.required,readOnly:e.readOnly,placeholder:e.placeholder,tabIndex:e.tabIndex};return"number"===i.type&&t.assign(i,{min:n.min,max:n.max}),n.pattern&&t.assign(i,{pattern:n.pattern}),n.maxLength&&t.assign(i,{maxLength:n.maxLength}),e.autoComplete&&"password"!==i.type&&(i.autoComplete="on"),i}.call(this),message:this.props.message?{children:this.props.message,style:{whiteSpace:"normal",display:"table"}}:r}}}}.apply(e,i))||(t.exports=o)},1737:function(t,e,n){var i,o;i=[n(0),n(4),n(1738),n(8),n(1)],void 0===(o=function(t,e,n,i,o){"use strict";var r=e.anchorTagsGenerator,s=o.xss.filterHtmlString;return{convertDataQueryLinksIntoHtmlAnchors:function(e,n,i){if(!n)return e;if(!i)return e.replace(/<a ([^>]*)dataquery="([^"]+)"([^>]*)>/g,function(e,i,o,r){return s("<a "+i+t.map(n[o],function(t,e){return e+'="'+t+'"'}).join(" ")+r+">")});var o=t.transform(n,function(t,e){t["#"+e.id]=e},{});return e.replace(/<a ([^>]*)dataquery="([^"]+)"([^>]*)>/g,function(e,n,r,a){var l=i(o[r]);return s("<a "+n+t.map(l,function(t,e){return e+'="'+t+'"'}).join(" ")+a+">")})},mobileTextTransformIfNeeded:function(t,e){return e.isMobileView?t=n.applyMobileAdjustments(t,e):t},createImpliedLinks:function(t){var e=r.getIncludedPatterns(i,t.isMobileView);return r.generateAnchorsInHtml(t.htmlContent,e)},applyTextStyleMigrationAdjustments:function(t,e){return n.applyTextStyleMigrationAdjustments(t,e)}}}.apply(e,i))||(t.exports=o)},1738:function(t,e,n){var i,o;i=[n(0),n(4),n(61)],void 0===(o=function(t,e,n){"use strict";var i=e.cssUtils,o=e.fragment;function r(t){var e=parseFloat(t);if(!isNaN(e))return e}function s(e){if(e)return t.head(e.split(","))}function a(t){if(t)return new n(i.normalizeColorStr(t))}function l(t,e,n){var i=t.getAttribute("style")||"",o=i.replace(new RegExp("(?:(^|;)\\s*)"+e+"\\s*:\\s*(?:.*?)\\s*(?:;|$)"),"$1")+(""!==i&&";"!==i[i.length-1]?";":"")+e+":"+n;t.setAttribute("style",o)}function c(t,n,i){if(n.fontSize&&n.fontSize%1==0&&(t.style.fontSize||h(t,i))){var o=parseFloat(i.scale);l(t,"font-size",Math.round(e.mobileUtils.convertFontSizeToMobile(n.fontSize,o))+"px")}}function u(e,n,i){if(function(e){if("a"!==e.tagName.toLowerCase())return;var n=function e(n){var i=n.parentElement;if(i&&"span"===i.tagName.toLowerCase()&&1===i.childNodes.length)return function(e){return!t.isEmpty(e.style.color)||e.className.match(/\bcolor_\d+\b/)}(i)?i:e(i);return null}(e);if(n)!function(e,n){e.style.color=n,e.className=e.className.replace(/\bcolor_\d+\b/,""),t.isEmpty(e.className)&&e.removeAttribute("class")}(n,"#0000FF");else{var i=e.ownerDocument.createElement("span");i.style.color="#0000FF",function(t,e){var n=t.parentNode,i=function(t){for(var e=t.parentNode,n=0;n<e.childNodes.length;n++)if(e.childNodes[n]===t)return n}(t);e.appendChild(t),n.insertBefore(e,n.childNodes[i])}(e,i)}}(e),!function(e){return e&&t.includes(["ol","ul"],e.tagName.toLowerCase())}(e)){var o=h(e,i);o&&(t.includes(e.getAttribute("style"),"line-height")||l(e,"line-height",o.lineHeight))}}function p(t,e,i){if(e.color){var o=h(t,i);if(t.style.color||d(t,o,i)){var r=parseFloat(i.brightness);l(t,"color",function(t,e){var i="#000000"!==t.hexString()?t.clone():new n("#121212");return i.lightness(i.hslArray()[2]*(e||1)),i}(e.color,r).rgbaString())}}}function f(t,e,n){var i=h(t,n);(t.style.color||d(t,i,n)||function(t){return!(!t||!t.color)}(i))&&l(t,"color",n.overrideColor.replace(/(^\d+,\d+,\d+,\d+$)/,"rgba($1)"))}function h(t,e){var n=/(?:\s|^)(font_\d+)(?:\s|$)/g.exec(t.className);if(n){var o=e.fontGetter&&e.fontGetter(n[1]);return o?i.parseFontStr(o):void 0}}function d(e,n,i){var o=function(t){var e=/(?:\s|^)(color_\d+)(?:\s|$)/g.exec(t.className);if(e)return e[1]}(e)||function(e){var n=/^{(color_\d+)}$/.exec(t.get(e,"color"));if(n)return n[1]}(n);if(o){var r=i.colorGetter&&i.colorGetter(o);return r||void 0}}function m(e,n,i,o){var l=t.defaults(function(e){var n=t(e.style).pick(["fontSize","fontFamily","color"]).omitBy(t.isEmpty).value();return{fontSize:r(n.fontSize),fontName:s(n.fontFamily),color:a(n.color)}}(e),function(e,n){var i=h(e,n),o=d(e,i,n);return{fontSize:r(t.get(i,"size")),fontName:s(t.get(i,"family")),color:a(o)}}(e,o),n);t.forEach(e.children,function(t){m(t,l,i,o)}),t.invokeMap(i,"call",null,e,l)}function v(t,e,n){m(t,{characterCount:t.textContent.length},e,n)}function g(e,n){var i=function(e){var n=[];return e.overrideColor?n.push(t.partial(f,t,t,e)):e.brightness&&1!==parseFloat(e.brightness)&&n.push(t.partial(p,t,t,e)),e.scale&&n.push(t.partial(c,t,t,e)),e.fixMigratedStyle&&n.push(t.partial(u,t,t,e)),n}(n);if(0===i.length)return e;var r=o.document.createDocumentFragment().appendChild(o.document.createElement("div"));return r.innerHTML=e,t.forEach(r.children,t.partial(v,t,i,n)),r.innerHTML}return{applyMobileAdjustments:g,applyTextStyleMigrationAdjustments:function(t,e){return g(t,{fontGetter:e,fixMigratedStyle:!0})}}}.apply(e,i))||(t.exports=o)},2:function(t,e){t.exports=n},3:function(t,e){t.exports=i},4:function(t,e){t.exports=o},5:function(t,e){t.exports=r},6:function(t,e){t.exports=s},61:function(t,e){t.exports=c},7:function(t,e){t.exports=a},8:function(t,e){t.exports=l}})});
//# sourceMappingURL=textCommon.min.js.map